# Benchmark resources organization

## Overview

This folder contains the ODE-FeatureEngine signal processing standardization tests reference values.
Sub-folders are as follow:

+ `sounds` contains the wav files.
+ `metadata` contains metadata that describe the wav files.
+ `results` contains the features generated by benchmarks.
  + `feature_engine_benchmark` contains the results generated by FeatureEngine-benchmark.
    + `RUNID_X` - contains the results for a run of FeatureEngine-benchmark on a data set using a set of parameters.
  + `LANGUAGE_VERSION` (eg `python_vanilla`) contains the results generated using a `LANGUAGE`
    and the `VERSION` version of the benchmark.
    + `RUNID_X` - contains the results for a run of `LANGUAGE_VERSION` on a data set using a set of parameters.
      + `SOUNDID_X.json` - The results of the benchmark run on the sound identified by `SOUNDID_X`.

## Benchmark run

A run of a benchmark (eg FeatureEngine-benchmark) is done on a data set using a set of
parameters. Thus, it can be referred with an identifier `RUNID`:

```bash
DATASETID_SEGMENTSIZE_WINDOWSIZE_WINDOWOVERLAP_NFFT
```

With:

+ `DATASETID` - An identifier of the data set used to generate the results (eg `example` for the sample data in this project resources or `spm500files`)
+ `SEGMENTSIZE` - The size of the first level of segmentation for acoustic features computation (in samples)
+ `WINDOWSIZE` - The size of the second level of segmentation for acoustic features computation (in samples)
+ `WINDOWOVERLAP` - The overlap of the second level of segmentation for acoustic features computation (in samples)
+ `NFFT` - The size of the fft-computation window

All these parameters fully describe the generation of the results.

_Note: some parameters, such as the window function used, have been statically
set across the benchmarks (eg all benchmarks use the hamming window function)._

## Files conventions

### Sounds

Wav Files in the `sounds` folder should be encoded as `PCM Little-Endian` and named as follow:

```bash
SOUNDID_WAVBITS_SAMPLENUMBER_SAMPRATE_CHANSNUMBER.wav
```

With:

+ `SOUNDID` - The sound identifier, unique among sounds
+ `WAVBITS` - The number of bits used for sound encoding (`8`, `16` or `24` generally)
+ `SAMPLENUMBER` - The number of samples in the sound file
+ `SAMPRATE` - The sampling rate the sound is using in Hz (usual values are `3900.0` `16000`, `44100`, `96000.0`...)
+ `CHANSNUNMBER` - The number of channels the file contains (`1` for mono, `2` for stereo etc)

### Results

#### Naming

Except for FeatureEngine-benchmark results, the results json files are named:

```bash
SOUNDID.json
```

With `SOUNDID`: The identifier of the sound used to generate acoustic features

#### Format

The results are saved as in a json file that contains one json object per line,
each line corresponds the a time segment. Json object are formatted as follow:

```json
{
  "timestamp": "1970-01-01T00:00:00+00:00",
  "welch": [[...]],
  "spl": [[...]],
  "tol": [[...]],
  "aux0": ...,
  ...
}
```

The acoustic features are 2-dimensional arrays, the first dimension corresponds
to the sound channel and the second to the feature itself.

#### FeatureEngine-benchmark results

FeatureEngine-benchmark save its results using spark's default json writer
which write results using the same format as the one described above except
that it creates one json file per partition instead of one per file.
